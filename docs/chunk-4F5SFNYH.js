import{a as V}from"./chunk-LFKNZO6Y.js";import{a as F}from"./chunk-4UGSAFNV.js";import{l as I}from"./chunk-VSNPEVEX.js";import{a as D,c as k,e as E,n as M}from"./chunk-NMPAONDN.js";import{Ca as f,Ea as m,Fa as c,H as y,Ja as u,La as C,O as _,P as p,Ra as T,aa as l,ba as g,ja as h,la as x,lb as S,na as b,ta as d,va as v,wa as w,xa as o,ya as s}from"./chunk-HYLWAQAG.js";var N=(t,r)=>r.id;function $(t,r){if(t&1){let e=f();o(0,"button",12),m("click",function(){_(e);let n=c().$implicit,a=c(2);return p(a.openModal("edit",n.id))}),u(1," \u062A\u0639\u062F\u064A\u0644 "),s(),o(2,"button",13),m("click",function(){_(e);let n=c().$implicit,a=c(2);return p(a.openModal("delete",n.id))}),u(3," \u062D\u0630\u0641 "),s()}}function j(t,r){t&1&&(o(0,"span",14),u(1,"\u0644\u0627 \u064A\u0645\u0643\u0646 \u0627\u0644\u062A\u0639\u062F\u064A\u0644"),s())}function q(t,r){if(t&1&&(o(0,"div",7)(1,"h3",9),u(2),s(),o(3,"p",10),u(4),s(),o(5,"div",11),x(6,$,4,0)(7,j,2,0),s()()),t&2){let e=r.$implicit,i=c(2);l(2),C(" ",e.name," "),l(2),C(" ",i.isDefaultAssistance(e)?"\u0627\u0641\u062A\u0631\u0627\u0636\u064A":"\u0645\u062E\u0635\u0635"," "),l(2),d(6,i.isDefaultAssistance(e)?7:6)}}function L(t,r){t&1&&(o(0,"div",8),u(1,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A \u0646\u0634\u0637\u0629"),s())}function z(t,r){if(t&1&&(v(0,q,8,3,"div",7,N),x(2,L,2,0,"div",8)),t&2){let e=c();w(e.assistanceTypes()),l(2),d(2,e.assistanceTypes().length?-1:2)}}function B(t,r){if(t&1){let e=f();o(0,"div",7)(1,"h3",9),u(2),s(),o(3,"p",15),u(4,"\u0645\u062E\u0635\u0635"),s(),o(5,"div",11)(6,"button",12),m("click",function(){let n=_(e).$implicit,a=c(2);return p(a.openModal("edit",n.id))}),u(7," \u062A\u0639\u062F\u064A\u0644 "),s(),o(8,"button",16),m("click",function(){let n=_(e).$implicit,a=c(2);return p(a.openModal("restore",n.id))}),u(9," \u0627\u0633\u062A\u0639\u0627\u062F\u0629 "),s()()()}if(t&2){let e=r.$implicit;l(2),C(" ",e.name," ")}}function G(t,r){t&1&&(o(0,"div",8),u(1,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A \u0645\u062D\u0630\u0648\u0641\u0629"),s())}function H(t,r){if(t&1&&(v(0,B,10,1,"div",7,N),x(2,G,2,0,"div",8)),t&2){let e=c();w(e.deletedAssistanceTypes()),l(2),d(2,e.deletedAssistanceTypes().length?-1:2)}}function J(t,r){if(t&1){let e=f();o(0,"div",19)(1,"input",23),m("ngModelChange",function(n){_(e);let a=c(2);return p(a.newAssistanceName.set(n))}),s()()}if(t&2){let e=c(2);l(),b("ngModel",e.newAssistanceName())}}function K(t,r){t&1&&(o(0,"p",20),u(1,"\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 \u0646\u0648\u0639 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629\u061F"),s())}function O(t,r){t&1&&(o(0,"p",20),u(1,"\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u0627\u0633\u062A\u0639\u0627\u062F\u0629 \u0646\u0648\u0639 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629\u061F"),s())}function P(t,r){if(t&1){let e=f();o(0,"button",24),m("click",function(){_(e);let n=c(2);return p(n.saveAssistance())}),u(1," \u062D\u0641\u0638 "),s()}}function Q(t,r){if(t&1){let e=f();o(0,"button",25),m("click",function(){_(e);let n=c(2);return p(n.confirmAction())}),u(1," \u062A\u0623\u0643\u064A\u062F "),s()}}function R(t,r){if(t&1){let e=f();o(0,"div",6)(1,"div",17)(2,"h2",18),u(3),s(),x(4,J,2,1,"div",19)(5,K,2,0,"p",20)(6,O,2,0,"p",20),o(7,"div",11)(8,"button",3),m("click",function(){_(e);let n=c();return p(n.closeModal())}),u(9," \u0625\u0644\u063A\u0627\u0621 "),s(),x(10,P,2,0,"button",21)(11,Q,2,0,"button",22),s()()()}if(t&2){let e=c();l(3),C(" ",e.modalAction()==="add"?"\u0625\u0636\u0627\u0641\u0629":e.modalAction()==="edit"?"\u062A\u0639\u062F\u064A\u0644":e.modalAction()==="delete"?"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062D\u0630\u0641":"\u0627\u0633\u062A\u0639\u0627\u062F\u0629"," \u0646\u0648\u0639 \u0645\u0633\u0627\u0639\u062F\u0629 "),l(),d(4,e.modalAction()!=="delete"&&e.modalAction()!=="restore"?4:-1),l(),d(5,e.modalAction()==="delete"?5:-1),l(),d(6,e.modalAction()==="restore"?6:-1),l(4),d(10,e.modalAction()!=="delete"&&e.modalAction()!=="restore"?10:-1),l(),d(11,e.modalAction()==="delete"||e.modalAction()==="restore"?11:-1)}}var se=(()=>{class t{constructor(e,i,n){this.assistanceService=e,this.toastr=i,this.authService=n,this.assistanceTypes=h([]),this.deletedAssistanceTypes=h([]),this.showDeleted=h(!1),this.showModal=h(!1),this.modalAction=h("add"),this.selectedAssistanceId=h(null),this.newAssistanceName=h(""),this.storeId=h(null),this.storeId.set(parseInt(this.authService.getStoreId()||"0")),this.loadAssistanceTypes()}loadAssistanceTypes(){this.storeId()&&this.assistanceService.getAllAssistanceTypes(this.storeId()).subscribe({next:e=>{e.isSuccess&&e.data&&this.assistanceTypes.set(e.data)},error:()=>this.toastr.error("\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0627\u0646\u062A\u0631\u0646\u062A \u0627\u0644\u062E\u0627\u0635 \u0628\u0643")})}loadDeletedAssistanceTypes(){this.storeId()&&this.assistanceService.getAllDeletedAssistanceTypes(this.storeId()).subscribe({next:e=>{e.isSuccess&&e.data&&this.deletedAssistanceTypes.set(e.data.filter(i=>this.isCustomAssistance(i)))}})}toggleShowDeleted(){this.showDeleted.update(e=>!e),this.showDeleted()&&this.deletedAssistanceTypes().length===0&&this.loadDeletedAssistanceTypes()}openModal(e,i){if(this.modalAction.set(e),this.showModal.set(!0),this.selectedAssistanceId.set(i??null),e==="edit"&&i!=null){let a=(this.showDeleted()?this.deletedAssistanceTypes():this.assistanceTypes()).find(A=>A.id===i);a&&this.newAssistanceName.set(a.name)}else this.newAssistanceName.set("")}closeModal(){this.showModal.set(!1),this.newAssistanceName.set(""),this.selectedAssistanceId.set(null),this.modalAction.set("add")}saveAssistance(){let e=this.newAssistanceName(),i=this.modalAction(),n=this.selectedAssistanceId();if(!e&&i!=="delete"&&i!=="restore"||!this.storeId())return;let a;if(i==="add")a=this.assistanceService.createAssistanceType(this.storeId(),e);else if(i==="edit"&&n!=null)a=this.assistanceService.updateAssistanceType(n,e);else{this.closeModal();return}a.subscribe({next:A=>{A.isSuccess&&A.data?(this.loadAssistanceTypes(),this.showDeleted()&&this.loadDeletedAssistanceTypes(),this.toastr.success(A.message||"\u062A\u0645\u062A \u0627\u0644\u0639\u0645\u0644\u064A\u0629 \u0628\u0646\u062C\u0627\u062D"),this.closeModal()):this.toastr.error("\u0641\u0634\u0644 \u0627\u0644\u0639\u0645\u0644\u064A\u0629")},error:()=>this.toastr.error("\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0627\u0646\u062A\u0631\u0646\u062A \u0627\u0644\u062E\u0627\u0635 \u0628\u0643")})}confirmAction(){let e=this.modalAction(),i=this.selectedAssistanceId();if(!i)return;let n;if(e==="delete")n=this.assistanceService.deleteAssistanceType(i);else if(e==="restore")n=this.assistanceService.restoreAssistanceType(i);else{this.closeModal();return}n.subscribe({next:a=>{a.isSuccess?(e==="restore"&&this.deletedAssistanceTypes.set(this.deletedAssistanceTypes().filter(A=>A.id!==i)),this.loadAssistanceTypes(),this.loadDeletedAssistanceTypes(),setTimeout(()=>{this.deletedAssistanceTypes().length===0&&this.showDeleted()&&this.loadDeletedAssistanceTypes()},0),this.toastr.success(a.message||"\u062A\u0645\u062A \u0627\u0644\u0639\u0645\u0644\u064A\u0629 \u0628\u0646\u062C\u0627\u062D"),this.closeModal()):this.toastr.error("\u0641\u0634\u0644 \u0627\u0644\u0639\u0645\u0644\u064A\u0629")},error:()=>{this.toastr.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u0639\u0645\u0644\u064A\u0629")}})}isCustomAssistance(e){return e.id>0&&!this.isDefaultAssistance(e)}isDefaultAssistance(e){return e.id<999}static{this.\u0275fac=function(i){return new(i||t)(g(V),g(I),g(F))}}static{this.\u0275cmp=y({type:t,selectors:[["app-assistance"]],standalone:!0,features:[T],decls:12,vars:5,consts:[["dir","rtl",1,"container","mx-auto","p-6","text-gray-400"],[1,"text-2xl","font-bold","text-white","mb-6"],[1,"mb-6","flex","items-center","gap-3"],[1,"px-4","py-2","bg-gray-600","text-white","rounded-lg","hover:bg-gray-700","transition",3,"click"],[1,"px-4","py-2","bg-green-500","text-white","rounded-lg","hover:bg-green-600","transition",3,"click","disabled"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","p-4"],[1,"w-full","border","border-gray-700","rounded-lg","shadow-sm","p-4"],[1,"text-center","text-gray-400","p-4"],[1,"text-lg","font-semibold","text-white","mb-2"],[1,"text-sm","text-gray-100","font-bold","mb-2"],[1,"flex","justify-end","space-x-2","space-x-reverse"],[1,"px-3","py-1","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600","transition",3,"click"],[1,"px-3","py-1","bg-red-500","text-white","rounded-lg","hover:bg-red-600","transition",3,"click"],[1,"text-gray-300"],[1,"text-sm","text-gray-200","mb-2"],[1,"px-3","py-1","bg-green-500","text-white","rounded-lg","hover:bg-green-600","transition",3,"click"],[1,"bg-gray-800","p-6","rounded-lg","w-full","max-w-sm"],[1,"text-xl","font-bold","text-white","mb-4"],[1,"mb-4"],[1,"mb-4","text-gray-400"],[1,"px-4","py-2","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600","transition"],[1,"px-4","py-2","bg-red-500","text-white","rounded-lg","hover:bg-red-600","transition"],["placeholder","\u0627\u0633\u0645 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629",1,"w-full","px-3","py-2","border","border-gray-600","rounded-lg","bg-gray-700","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"px-4","py-2","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600","transition",3,"click"],[1,"px-4","py-2","bg-red-500","text-white","rounded-lg","hover:bg-red-600","transition",3,"click"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"h1",1),u(2,"\u0623\u0646\u0648\u0627\u0639 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629"),s(),o(3,"div",2)(4,"button",3),m("click",function(){return n.toggleShowDeleted()}),u(5),s(),o(6,"button",4),m("click",function(){return n.openModal("add")}),u(7," \u0625\u0636\u0627\u0641\u0629 \u0646\u0648\u0639 \u0645\u0633\u0627\u0639\u062F\u0629 "),s()(),o(8,"div",5),x(9,z,3,1)(10,H,3,1),s(),x(11,R,12,6,"div",6),s()),i&2&&(l(5),C(" ",n.showDeleted()?"\u0639\u0631\u0636 \u0627\u0644\u0646\u0634\u0637":"\u0639\u0631\u0636 \u0627\u0644\u0645\u062D\u0630\u0648\u0641"," "),l(),b("disabled",!n.storeId()),l(3),d(9,n.showDeleted()?-1:9),l(),d(10,n.showDeleted()?10:-1),l(),d(11,n.showModal()?11:-1))},dependencies:[M,D,k,E,S],encapsulation:2})}}return t})();export{se as AssistanceComponent};
