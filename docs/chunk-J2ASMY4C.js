import{a as se,b as le,c as ue}from"./chunk-T4ISPZRZ.js";import{a as re}from"./chunk-LFKNZO6Y.js";import{a as ae}from"./chunk-7HQIZKG2.js";import{a as ie,b as ne,c as oe}from"./chunk-DJIB2ZBT.js";import{a as H}from"./chunk-4UGSAFNV.js";import{l as N}from"./chunk-VSNPEVEX.js";import{a as K,c as X,e as Y,j as Z,k as ee,n as te}from"./chunk-NMPAONDN.js";import{B as D,Bb as J,Ca as C,E as W,Ea as d,Fa as c,H as A,Ja as a,Ka as E,La as w,Na as q,O as m,Oa as O,P as _,Pa as R,Ra as M,Ua as z,a as L,aa as l,b as G,ba as g,gb as V,ja as p,la as v,lb as F,na as I,nb as U,ra as B,ta as f,ua as j,va as b,wa as S,wb as Q,xa as o,ya as r,za as k}from"./chunk-HYLWAQAG.js";var fe=(i,u)=>u.id,ge=(i,u)=>({"transform translate-x-0":i,"transform translate-x-full":u});function xe(i,u){if(i&1){let e=C();o(0,"li",8)(1,"div",10),d("click",function(){let t=m(e).$implicit,s=c();return _(s.confirmRequest(t))}),o(2,"div",11),k(3,"i",12),r(),o(4,"button",13),a(5),r()()()}if(i&2){let e=u.$implicit,n=c();l(3),B("fa-solid ",n.getIconClass(e.id)," fa-2xl"),l(2),w(" ",e.name," ")}}function Ce(i,u){if(i&1){let e=C();o(0,"div",9)(1,"div",14)(2,"h3",15),a(3,"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u0637\u0644\u0628"),r(),o(4,"p",16),a(5),r(),o(6,"div",17)(7,"button",18),d("click",function(){m(e);let t=c();return _(t.proceedWithRequest())}),a(8," \u0646\u0639\u0645 "),r(),o(9,"button",19),d("click",function(){m(e);let t=c();return _(t.cancelRequest())}),a(10," \u0625\u0644\u063A\u0627\u0621 "),r()()()()}if(i&2){let e=c();l(5),w(' \u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0623\u0646\u0643 \u062A\u0631\u064A\u062F \u0637\u0644\u0628 "',e.selectedAssistance==null?null:e.selectedAssistance.name,'"\u061F ')}}var de=(()=>{class i{constructor(e,n,t,s){this.assistanceService=e,this.authService=n,this.requestService=t,this.toastr=s,this.assistances=[],this.showConfirmModal=!1,this.storeId=null,this.isSidenavOpen=!1,this.iconMap={5:"fa-battery-quarter",3:"fa-display",4:"fa-question",2:"fa-gamepad",1:"fa-arrows-rotate"},this.storeId=parseInt(this.authService.getStoreId()||"0")}ngOnInit(){this.loadAssistances()}loadAssistances(){if(!this.storeId){this.toastr.error("\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u0639\u062B\u0648\u0631 \u0639\u0644\u0649 \u0645\u0639\u0631\u0641 \u0627\u0644\u0645\u062A\u062C\u0631","\u062E\u0637\u0623");return}this.assistanceService.getAllAssistanceTypes(this.storeId).subscribe({next:e=>{e.isSuccess&&e.data?this.assistances=e.data.reverse():this.toastr.error(e.message||"\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0623\u0646\u0648\u0627\u0639 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629","\u062E\u0637\u0623")},error:e=>{console.error("Failed to load assistances:",e),this.toastr.error("\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0623\u0646\u0648\u0627\u0639 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629","\u062E\u0637\u0623")}})}getIconClass(e){return e>=1e3?"fa-gears":this.iconMap[e]||"fa-question-circle"}confirmRequest(e){this.selectedAssistance=e,this.showConfirmModal=!0}proceedWithRequest(){if(!this.selectedAssistance)return;let e=parseInt(this.authService.getRoomId()||"0");if(!e){this.toastr.error("\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u0639\u062B\u0648\u0631 \u0639\u0644\u0649 \u0645\u0639\u0631\u0641 \u0627\u0644\u063A\u0631\u0641\u0629","\u062E\u0637\u0623");return}this.requestService.createAssistanceRequest({roomId:e,requestTypeId:this.selectedAssistance.id}).subscribe({next:n=>{n.isSuccess?this.toastr.success("\u062A\u0645 \u0625\u0631\u0633\u0627\u0644 \u0637\u0644\u0628 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629 \u0628\u0646\u062C\u0627\u062D","\u0646\u062C\u0627\u062D"):this.toastr.error(n.message||"\u0641\u0634\u0644 \u0625\u0631\u0633\u0627\u0644 \u0637\u0644\u0628 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629","\u062E\u0637\u0623")},error:n=>{console.error("Failed to send assistance request:",n),this.toastr.error("\u0641\u0634\u0644 \u0625\u0631\u0633\u0627\u0644 \u0637\u0644\u0628 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629","\u062E\u0637\u0623")}}),this.showConfirmModal=!1,this.selectedAssistance=void 0}cancelRequest(){this.showConfirmModal=!1,this.selectedAssistance=void 0}toggleSidenav(){this.isSidenavOpen=!this.isSidenavOpen;let e=document.querySelector(".main-content");e&&e.classList.toggle("sidenav-open",this.isSidenavOpen)}static{this.\u0275fac=function(n){return new(n||i)(g(re),g(H),g(se),g(N))}}static{this.\u0275cmp=A({type:i,selectors:[["app-sidenav"]],standalone:!0,features:[M],decls:15,vars:5,consts:[[1,"relative"],["dir","rtl",1,"sidenav","h-screen","w-44","p-4","shadow-lg","bg-black","b","transition-transform","duration-300",3,"ngClass"],[1,"help-button","absolute","left-[-60px]","top-1/2","transform","-translate-y-1/2","bg-black","text-white","p-3","rounded-l-lg","cursor-pointer","flex","flex-col","items-center",3,"click"],[1,"fa-solid","fa-gears","fa-2xl","mb-2"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-lg","font-bold","text-white"],[1,"text-white",3,"click"],[1,"fa-solid","fa-times","fa-lg"],[1,"my-8"],[1,"fixed","inset-0","bg-black","bg-opacity-90","flex","items-center","justify-center","z-50"],[1,"cursor-pointer",3,"click"],[1,"w-full","text-center","my-2"],[2,"color","#ffffff"],[1,"w-full","text-center","px-3","py-2","bg-gray-500","text-white","rounded-lg","hover:bg-gray-600","transition"],[1,"rounded-xl","text-white","p-6","w-80","shadow-lg","text-center"],[1,"text-lg","font-bold","mb-4"],[1,"mb-6"],[1,"flex","justify-between","gap-4"],[1,"bg-green-600","text-white","px-4","py-2","rounded-lg","hover:bg-green-700","transition","w-full",3,"click"],[1,"bg-gray-400","text-white","px-4","py-2","rounded-lg","hover:bg-gray-500","transition","w-full",3,"click"]],template:function(n,t){n&1&&(o(0,"div",0)(1,"div",1)(2,"div",2),d("click",function(){return t.toggleSidenav()}),k(3,"i",3),o(4,"span"),a(5,"Help!"),r()(),o(6,"div",4)(7,"h2",5),a(8,"\u0637\u0644\u0628\u0627\u062A \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629"),r(),o(9,"button",6),d("click",function(){return t.toggleSidenav()}),k(10,"i",7),r()(),o(11,"ul"),b(12,xe,6,4,"li",8,fe),r()(),v(14,Ce,11,1,"div",9),r()),n&2&&(l(),I("ngClass",z(2,ge,t.isSidenavOpen,!t.isSidenavOpen)),l(11),S(t.assistances),l(2),f(14,t.showConfirmModal?14:-1))},dependencies:[F,V],styles:[".sidenav[_ngcontent-%COMP%]{position:fixed;top:0;right:0;z-index:1000}.help-button[_ngcontent-%COMP%]{z-index:999}.main-content[_ngcontent-%COMP%]{transition:transform .3s ease}.main-content.sidenav-open[_ngcontent-%COMP%]{transform:translate(-44px)}"]})}}return i})();var me=(()=>{class i{constructor(e){this.http=e,this.apiUrl=`${J.apiUrl}/customer`}loginCustomer(e,n){return this.http.post(`${this.apiUrl}/login`,{PhoneNumber:e,StoreId:n})}getCustomerByPhone(e,n){return this.http.post(`${this.apiUrl}/phone`,{PhoneNumber:e,StoreId:n})}static{this.\u0275fac=function(n){return new(n||i)(W(U))}}static{this.\u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var be=(i,u)=>u.categoryId,$=(i,u)=>u.id,Se=(i,u)=>u.menuItemId;function we(i,u){if(i&1){let e=C();o(0,"div",22)(1,"div",23)(2,"button",24),d("click",function(){let t=m(e).$implicit,s=c(7);return _(s.addToCart(t))}),a(3," \u0625\u0636\u0627\u0641\u0629 "),r(),o(4,"p",25),a(5),r()(),o(6,"div")(7,"p"),a(8),r()()()}if(i&2){let e=u.$implicit;l(5),E(e.name),l(3),w("",e.price," \u062C\u0646\u064A\u0647")}}function ye(i,u){if(i&1&&(o(0,"div",19),k(1,"hr",20),o(2,"h2",21),a(3),r(),k(4,"hr",20),r(),b(5,we,9,2,"div",22,$)),i&2){let e=u.$implicit;l(3),E(e.categoryName),l(2),S(e.items)}}function Ie(i,u){if(i&1&&b(0,ye,7,1,null,null,be),i&2){let e=c(2).$implicit;S(e.groups)}}function ke(i,u){if(i&1){let e=C();o(0,"div",22)(1,"div",23)(2,"button",24),d("click",function(){let t=m(e).$implicit,s=c(6);return _(s.addToCart(t))}),a(3," \u0625\u0636\u0627\u0641\u0629 "),r(),o(4,"p",25),a(5),r()(),o(6,"div")(7,"p"),a(8),r()()()}if(i&2){let e=u.$implicit;l(5),E(e.name),l(3),w("",e.price," \u062C\u0646\u064A\u0647")}}function Ee(i,u){if(i&1&&b(0,ke,9,2,"div",22,$),i&2){let e=c(2).$implicit;S(e.items)}}function Te(i,u){if(i&1&&(o(0,"div",18),v(1,Ie,2,0)(2,Ee,2,0),r()),i&2){let e=c(4);l(),f(1,e.viewMode()==="byCategory"?1:2)}}function Ae(i,u){i&1&&v(0,Te,3,1,"ng-template",17)}function Me(i,u){if(i&1&&(o(0,"div",15)(1,"owl-carousel-o",16),b(2,Ae,1,0,null,17,j),r()()),i&2){let e=c(2);l(),I("options",e.carouselOptions),l(),S(e.getItemChunks())}}function Ve(i,u){i&1&&(o(0,"div",26),a(1,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0623\u0635\u0646\u0627\u0641 \u0645\u062A\u0627\u062D\u0629"),r())}function Fe(i,u){if(i&1){let e=C();o(0,"div")(1,"div",6)(2,"div",7)(3,"button",8),d("click",function(){m(e);let t=c();return _(t.openCartModal())}),a(4),r()(),o(5,"div",9)(6,"select",10),d("change",function(t){m(e);let s=c();return _(s.toggleView(t))}),o(7,"option",11),a(8,"\u062D\u0633\u0628 \u0627\u0644\u0643\u0627\u062A\u064A\u062C\u0648\u0631\u064A"),r(),o(9,"option",12),a(10,"\u0639\u0631\u0636 \u0627\u0644\u0643\u0644"),r()(),o(11,"select",10),d("change",function(t){m(e);let s=c();return _(s.sortItems(t))}),o(12,"option",13),a(13,"\u0627\u0644\u0623\u0639\u0644\u0649 \u0633\u0639\u0631\u0627\u064B"),r(),o(14,"option",14),a(15,"\u0627\u0644\u0623\u0642\u0644 \u0633\u0639\u0631\u0627\u064B"),r()()()(),v(16,Me,4,1,"div",15)(17,Ve,2,0),r()}if(i&2){let e=c();l(3),I("disabled",!e.cart().length),l(),w(" \u062A\u0623\u0643\u064A\u062F \u0627\u0644\u0637\u0644\u0628 (",e.cart().length,") "),l(12),f(16,e.categories().length&&e.items().length?16:17)}}function He(i,u){if(i&1){let e=C();o(0,"div",22)(1,"div",23)(2,"button",24),d("click",function(){let t=m(e).$implicit,s=c(5);return _(s.requestGift(t))}),a(3," \u0637\u0644\u0628 \u0627\u0644\u0647\u062F\u064A\u0629 "),r(),o(4,"p",25),a(5),r()(),o(6,"div")(7,"p"),a(8),r()()()}if(i&2){let e=u.$implicit;l(5),E(e.name),l(3),w("",e.pointsRequired," \u0646\u0642\u0637\u0629")}}function Ne(i,u){if(i&1&&(o(0,"div",18),b(1,He,9,2,"div",22,$),r()),i&2){let e=c().$implicit;l(),S(e)}}function Pe(i,u){i&1&&v(0,Ne,3,0,"ng-template",17)}function je(i,u){if(i&1&&(o(0,"div",15)(1,"owl-carousel-o",16),b(2,Pe,1,0,null,17,j),r()()),i&2){let e=c(2);l(),I("options",e.carouselOptions),l(),S(e.getGiftChunks())}}function qe(i,u){i&1&&(o(0,"div",26),a(1,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0647\u062F\u0627\u064A\u0627 \u0645\u062A\u0627\u062D\u0629"),r())}function Oe(i,u){if(i&1&&(o(0,"div"),v(1,je,4,1,"div",15)(2,qe,2,0),r()),i&2){let e=c();l(),f(1,e.gifts().length?1:2)}}function Re(i,u){if(i&1){let e=C();o(0,"div",30)(1,"div")(2,"p",25),a(3),r(),o(4,"p",36),a(5),r()(),o(6,"div",37)(7,"button",38),d("click",function(){let t=m(e).$implicit,s=c(3);return _(s.updateQuantity(t.menuItemId,1))}),a(8," + "),r(),o(9,"button",38),d("click",function(){let t=m(e).$implicit,s=c(3);return _(s.updateQuantity(t.menuItemId,-1))}),a(10," - "),r(),o(11,"button",39),d("click",function(){let t=m(e).$implicit,s=c(3);return _(s.removeItem(t.menuItemId))}),a(12," \u062D\u0630\u0641 "),r()()()}if(i&2){let e=u.$implicit;l(3),E(e.name),l(2),E(e.quantity)}}function $e(i,u){if(i&1){let e=C();o(0,"div",29),b(1,Re,13,2,"div",30,Se),r(),o(3,"p",31),a(4),r(),o(5,"div",32)(6,"button",33),d("click",function(){m(e);let t=c(2);return _(t.openLoginModal())}),a(7," \u062A\u0623\u0643\u064A\u062F "),r(),o(8,"button",34),d("click",function(){m(e);let t=c(2);return _(t.closeCartModal())}),a(9," \u0625\u0636\u0627\u0641\u0629 \u0637\u0644\u0628\u0627\u062A \u0623\u062E\u0631\u0649 "),r(),o(10,"button",35),d("click",function(){m(e);let t=c(2);return _(t.clearCart())}),a(11," \u0625\u0644\u063A\u0627\u0621 "),r()()}if(i&2){let e=c(2);l(),S(e.cart()),l(3),w("\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A: ",e.getTotalAmount()," \u062C\u0646\u064A\u0647")}}function Le(i,u){i&1&&(o(0,"p",40),a(1,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0637\u0644\u0628\u0627\u062A"),r())}function Ge(i,u){if(i&1&&(o(0,"div",5)(1,"div",27)(2,"h2",28),a(3,"\u0627\u0644\u0637\u0644\u0628\u0627\u062A"),r(),v(4,$e,12,1)(5,Le,2,0),r()()),i&2){let e=c();l(4),f(4,e.cart().length?4:5)}}function De(i,u){if(i&1){let e=C();o(0,"div",5)(1,"div",27)(2,"h2",28),a(3,"\u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u062E\u0648\u0644"),r(),o(4,"div",41)(5,"label",42),a(6,"\u0631\u0642\u0645 \u0627\u0644\u062A\u0644\u064A\u0641\u0648\u0646"),r(),o(7,"input",43),R("ngModelChange",function(t){m(e);let s=c();return O(s.phoneNumber,t)||(s.phoneNumber=t),_(t)}),r()(),o(8,"div",44)(9,"button",33),d("click",function(){m(e);let t=c();return _(t.submitLogin())}),a(10," \u062A\u0633\u062C\u064A\u0644 "),r(),o(11,"button",35),d("click",function(){m(e);let t=c();return _(t.closeLoginModal())}),a(12," \u0625\u0644\u063A\u0627\u0621 "),r()()()()}if(i&2){let e=c();l(7),q("ngModel",e.phoneNumber)}}function We(i,u){if(i&1&&(o(0,"p",47),a(1),r()),i&2){let e=c(2);l(),w("\u0646\u0642\u0627\u0637\u0643: ",e.points()," \u0646\u0642\u0637\u0629")}}function Be(i,u){if(i&1&&(o(0,"p",48),a(1),r()),i&2){let e=c(2);l(),E(e.pointsError())}}function ze(i,u){if(i&1){let e=C();o(0,"div",5)(1,"div",27)(2,"h2",28),a(3,"\u0627\u0633\u062A\u0639\u0644\u0627\u0645 \u0639\u0646 \u0627\u0644\u0646\u0642\u0627\u0637"),r(),o(4,"div",41)(5,"label",45),a(6,"\u0631\u0642\u0645 \u0627\u0644\u062A\u0644\u064A\u0641\u0648\u0646"),r(),o(7,"input",46),R("ngModelChange",function(t){m(e);let s=c();return O(s.pointsPhoneNumber,t)||(s.pointsPhoneNumber=t),_(t)}),r()(),v(8,We,2,1,"p",47)(9,Be,2,1,"p",48),o(10,"div",44)(11,"button",33),d("click",function(){m(e);let t=c();return _(t.checkPoints())}),a(12," \u0627\u0633\u062A\u0639\u0644\u0627\u0645 "),r(),o(13,"button",35),d("click",function(){m(e);let t=c();return _(t.closePointsModal())}),a(14," \u0625\u0644\u063A\u0627\u0621 "),r()()()()}if(i&2){let e=c();l(7),q("ngModel",e.pointsPhoneNumber),l(),f(8,e.points()!==null?8:-1),l(),f(9,e.pointsError()?9:-1)}}var mt=(()=>{class i{constructor(e,n,t,s,x,h,y){this.menuService=e,this.customerService=n,this.orderService=t,this.giftRedemptionService=s,this.toastr=x,this.authService=h,this.router=y,this.categories=p([]),this.items=p([]),this.gifts=p([]),this.error=p(null),this.cart=p([]),this.showCartModal=p(!1),this.showLoginModal=p(!1),this.showPointsModal=p(!1),this.phoneNumber=p(""),this.pointsPhoneNumber=p(""),this.points=p(null),this.pointsError=p(null),this.sortOption=p("price-desc"),this.viewMode=p("byCategory"),this.currentTab=p("orders"),this.selectedGift=p(null),this.carouselOptions={loop:!1,mouseDrag:!0,touchDrag:!0,pullDrag:!0,dots:!0,navSpeed:700,navText:["<",">"],items:1,nav:!0,autoWidth:!1,rtl:!0},this.storeId=this.authService.getStoreId()?parseInt(this.authService.getStoreId()):0,this.roomId=this.authService.getRoomId()?parseInt(this.authService.getRoomId()):0}ngOnInit(){if(!this.storeId||!this.roomId){this.toastr.error("\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u063A\u0631\u0641\u0629\u060C \u0633\u062C\u0644 \u062F\u062E\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649","\u062E\u0637\u0623"),this.router.navigate(["/room/login"]);return}this.loadCategories(),this.loadGifts()}setTab(e){this.currentTab.set(e)}loadCategories(){this.error.set(null),this.menuService.getCategories().subscribe({next:e=>{e.isSuccess&&e.data?(this.categories.set(e.data),this.loadAllItems()):this.error.set(e.message||"\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0623\u0642\u0633\u0627\u0645")},error:()=>this.toastr.error("\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0627\u0646\u062A\u0631\u0646\u062A \u0627\u0644\u062E\u0627\u0635 \u0628\u0643")})}loadAllItems(){let e=[],n=this.categories();if(!n.length){this.items.set([]);return}let t=0;n.forEach(s=>{this.menuService.getItems(s.id).subscribe({next:x=>{x.isSuccess&&x.data&&e.push(...x.data.map(h=>G(L({},h),{categoryId:s.id,categoryName:s.name}))),t++,t===n.length&&this.sortAndSetItems(e)},error:()=>{t++,t===n.length&&this.sortAndSetItems(e)}})})}loadGifts(){this.giftRedemptionService.getAvailableGifts(this.storeId).subscribe({next:e=>{e.isSuccess&&e.data?this.gifts.set(e.data):this.toastr.error(e.message||"\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0647\u062F\u0627\u064A\u0627")},error:()=>this.toastr.error("\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0627\u0646\u062A\u0631\u0646\u062A \u0627\u0644\u062E\u0627\u0635 \u0628\u0643")})}sortAndSetItems(e){let n=[];this.viewMode()==="byCategory"?this.categories().forEach(s=>{let x=e.filter(h=>h.categoryId===s.id).sort((h,y)=>this.sortOption()==="price-desc"?y.price-h.price:h.price-y.price);n.push(...x)}):n=[...e].sort((t,s)=>this.sortOption()==="price-desc"?s.price-t.price:t.price-s.price),this.items.set(n)}sortItems(e){let n=e.target;this.sortOption.set(n.value),this.sortAndSetItems(this.items())}toggleView(e){let n=e.target;this.viewMode.set(n.value),this.sortAndSetItems(this.items())}getItemChunks(){let e=[];if(this.viewMode()==="byCategory"){let n=[],t=0,s=0,x=this.items();for(;s<x.length;){let h=x[s],y=this.categories().find(P=>P.id===h.categoryId);if(!y){s++;continue}let T=n.find(P=>P.categoryId===h.categoryId);T||(T={categoryId:h.categoryId,categoryName:y.name||"",items:[]},n.push(T)),t<12?(T.items.push(h),t++,s++):(e.push({groups:[...n]}),n=[{categoryId:h.categoryId,categoryName:y.name||"",items:[]}],t=0)}n.length>0&&t>0&&e.push({groups:[...n]})}else{let n=this.items();for(let t=0;t<n.length;t+=12)e.push({items:n.slice(t,t+12)})}return e}getGiftChunks(){let e=[],n=this.gifts();for(let t=0;t<n.length;t+=12)e.push(n.slice(t,t+12));return e}addToCart(e){let n=this.cart(),t=n.find(s=>s.menuItemId===e.id);t?(t.quantity++,this.cart.set([...n]),this.toastr.success("\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0635\u0646\u0641 \u0625\u0644\u0649 \u0627\u0644\u0633\u0644\u0629")):(this.cart.set([...n,{menuItemId:e.id,quantity:1,name:e.name,price:e.price}]),this.toastr.success("\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0635\u0646\u0641 \u0625\u0644\u0649 \u0627\u0644\u0633\u0644\u0629"))}requestGift(e){this.selectedGift.set(e),this.openLoginModal()}openCartModal(){this.showCartModal.set(!0)}closeCartModal(){this.showCartModal.set(!1)}openLoginModal(){this.showLoginModal.set(!0),this.showCartModal.set(!1)}closeLoginModal(){this.showLoginModal.set(!1),this.currentTab()==="orders"&&this.showCartModal.set(!0),this.selectedGift.set(null)}openPointsModal(){this.showPointsModal.set(!0),this.pointsPhoneNumber.set(""),this.points.set(null),this.pointsError.set(null)}closePointsModal(){this.showPointsModal.set(!1),this.pointsPhoneNumber.set(""),this.points.set(null),this.pointsError.set(null)}checkPoints(){let e=this.pointsPhoneNumber().trim(),n=/^(010|011|012|015)[0-9]{8}$/;if(!e){this.pointsError.set("\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0631\u0642\u0645 \u0627\u0644\u062A\u0644\u064A\u0641\u0648\u0646");return}if(!n.test(e)){this.pointsError.set("\u0645\u0646 \u0641\u0636\u0644\u0643 \u0623\u062F\u062E\u0644 \u0631\u0642\u0645 \u062A\u0644\u064A\u0641\u0648\u0646 \u0635\u062D\u064A\u062D");return}this.customerService.loginCustomer(e,this.storeId).subscribe({next:t=>{t.isSuccess&&t.data?(this.points.set(t.data.points),this.pointsError.set(null)):(this.pointsError.set(t.message||"\u0631\u0642\u0645 \u0627\u0644\u062A\u0644\u064A\u0641\u0648\u0646 \u063A\u064A\u0631 \u0645\u0648\u062C\u0648\u062F"),this.points.set(null))},error:()=>{this.pointsError.set("\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0627\u0646\u062A\u0631\u0646\u062A \u0627\u0644\u062E\u0627\u0635 \u0628\u0643"),this.points.set(null)}})}updateQuantity(e,n){let t=this.cart(),s=t.find(x=>x.menuItemId===e);s&&(s.quantity=Math.max(1,s.quantity+n),this.cart.set([...t]))}removeItem(e){let n=this.cart();this.cart.set(n.filter(t=>t.menuItemId!==e)),this.toastr.success("\u062A\u0645 \u0625\u0632\u0627\u0644\u0629 \u0627\u0644\u0635\u0646\u0641 \u0645\u0646 \u0627\u0644\u0633\u0644\u0629")}clearCart(){this.cart.set([]),this.showCartModal.set(!1)}submitLogin(){let e=this.phoneNumber().trim(),n=/^(010|011|012|015)[0-9]{8}$/;if(!e){this.toastr.error("\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0631\u0642\u0645 \u0627\u0644\u062A\u0644\u064A\u0641\u0648\u0646","\u062E\u0637\u0623");return}if(!n.test(e)){this.toastr.error("\u0645\u0646 \u0641\u0636\u0644\u0643 \u0623\u062F\u062E\u0644 \u0631\u0642\u0645 \u062A\u0644\u064A\u0641\u0648\u0646 \u0635\u062D\u064A\u062D","\u062E\u0637\u0623");return}this.customerService.loginCustomer(e,this.storeId).subscribe({next:t=>{t.isSuccess&&t.data?this.currentTab()==="orders"?this.submitOrder():this.currentTab()==="gifts"&&this.selectedGift()&&this.submitGiftRedemption():this.toastr.error(t.message||"\u0641\u0634\u0644 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u062E\u0648\u0644","\u062E\u0637\u0623")},error:()=>this.toastr.error("\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0627\u0646\u062A\u0631\u0646\u062A \u0627\u0644\u062E\u0627\u0635 \u0628\u0643")})}submitOrder(){let e=this.cart();if(!e.length){this.toastr.error("\u0644\u0627 \u062A\u0648\u062C\u062F \u0637\u0644\u0628\u0627\u062A \u0644\u0625\u0631\u0633\u0627\u0644\u0647\u0627","\u062E\u0637\u0623");return}this.orderService.createOrder(this.phoneNumber(),this.roomId,e).subscribe({next:n=>{n.isSuccess&&n.data?(this.toastr.success("\u062A\u0645 \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0637\u0644\u0628 \u0628\u0646\u062C\u0627\u062D","\u0646\u062C\u0627\u062D"),this.clearCart(),this.closeLoginModal(),this.closeCartModal()):(this.toastr.error("\u0641\u0634\u0644 \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0637\u0644\u0628","\u062E\u0637\u0623"),this.showLoginModal.set(!0))},error:()=>{this.toastr.error("\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0627\u0646\u062A\u0631\u0646\u062A \u0627\u0644\u062E\u0627\u0635 \u0628\u0643"),this.showLoginModal.set(!0)}})}submitGiftRedemption(){let e=this.selectedGift();if(!e){this.toastr.error("\u0644\u0645 \u064A\u062A\u0645 \u0627\u062E\u062A\u064A\u0627\u0631 \u0647\u062F\u064A\u0629","\u062E\u0637\u0623");return}let n={giftId:e.id,customerNumber:this.phoneNumber(),roomId:this.roomId};this.giftRedemptionService.requestGiftRedemption(n).subscribe({next:t=>{t.isSuccess&&t.data?(this.toastr.success("\u062A\u0645 \u0625\u0631\u0633\u0627\u0644 \u0637\u0644\u0628 \u0627\u0644\u0647\u062F\u064A\u0629 \u0628\u0646\u062C\u0627\u062D","\u0646\u062C\u0627\u062D"),this.closeLoginModal(),this.selectedGift.set(null)):(this.toastr.error(t.message||"\u0641\u0634\u0644 \u0625\u0631\u0633\u0627\u0644 \u0637\u0644\u0628 \u0627\u0644\u0647\u062F\u064A\u0629","\u062E\u0637\u0623"),this.showLoginModal.set(!0))},error:()=>{this.toastr.error("\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0627\u0646\u062A\u0631\u0646\u062A \u0627\u0644\u062E\u0627\u0635 \u0628\u0643"),this.showLoginModal.set(!0)}})}getTotalAmount(){return this.cart().reduce((e,n)=>e+n.price*n.quantity,0)}static{this.\u0275fac=function(n){return new(n||i)(g(ae),g(me),g(le),g(ue),g(N),g(H),g(Q))}}static{this.\u0275cmp=A({type:i,selectors:[["app-home"]],standalone:!0,features:[M],decls:15,vars:7,consts:[["dir","rtl",1,"container","mx-auto","md:p-6"],[1,"mb-4","flex","justify-between","items-center"],[1,"bg-blue-600","text-white","px-4","py-2","rounded-lg","hover:bg-blue-700",3,"click"],[1,"grid","grid-cols-2","gap-2"],[1,"px-4","py-2","hover:bg-opacity-80",3,"click","ngClass"],[1,"fixed","inset-0","bg-black","bg-opacity-80","flex","items-center","justify-center","z-50"],[1,"md:flex","justify-between","items-center","gap-4"],[1,"text-center"],[1,"bg-blue-600","text-white","px-4","py-2","rounded-lg","hover:bg-blue-700","disabled:bg-gray-400","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","gap-4","justify-center"],[1,"p-2","border","rounded-lg",3,"change"],["value","byCategory"],["value","allItems"],["value","price-desc"],["value","price-asc"],[1,"bg-black","bg-opacity-20","md:px-12","px-6","text-white"],[3,"options"],["carouselSlide",""],[1,"md:px-12","lg:py-5"],[1,"flex","items-center","justify-center","mt-12"],[1,"md:w-[150px]","w-[50px]","mx-[10px]","border-white"],[1,"lg:text-xl","font-bold"],[1,"flex","justify-between","items-center","p-2"],[1,"flex","items-center"],[1,"p-1","bg-green-400","text-white","rounded-lg","hover:bg-green-500","mx-2",3,"click"],[1,"font-semibold"],[1,"text-center","text-gray-600"],[1,"rounded-lg","p-6","w-full","max-w-md","text-white"],[1,"text-xl","font-bold","mb-4"],[1,"space-y-4","max-h-96","overflow-y-auto"],[1,"flex","justify-between","items-center","border-b","pb-2"],[1,"mt-4","font-bold"],[1,"flex","justify-between","mt-4"],[1,"bg-green-600","text-white","px-4","py-2","rounded-lg","hover:bg-green-700",3,"click"],[1,"bg-blue-500","px-4","py-2","rounded-lg","text-white","hover:bg-blue-700",3,"click"],[1,"bg-red-600","text-white","px-4","py-2","rounded-lg","hover:bg-red-700",3,"click"],[1,"text-gray-100"],[1,"flex","items-center","gap-2"],[1,"bg-blue-600","text-white","px-2","py-1","rounded","hover:bg-blue-700",3,"click"],[1,"bg-red-600","text-white","px-2","py-1","rounded","hover:bg-red-700",3,"click"],[1,"text-gray-600"],[1,"mb-4"],["for","phoneNumber",1,"block","text-gray-700","mb-2"],["id","phoneNumber","type","text","placeholder","\u0627\u062F\u062E\u0644 \u0631\u0642\u0645 \u0627\u0644\u062A\u0644\u064A\u0641\u0648\u0646",1,"w-full","p-2","border","rounded-lg","text-black",3,"ngModelChange","ngModel"],[1,"flex","justify-between"],["for","pointsPhoneNumber",1,"block","text-gray-700","mb-2"],["id","pointsPhoneNumber","type","text","placeholder","\u0627\u062F\u062E\u0644 \u0631\u0642\u0645 \u0627\u0644\u062A\u0644\u064A\u0641\u0648\u0646",1,"w-full","p-2","border","rounded-lg","text-black",3,"ngModelChange","ngModel"],[1,"mb-4","text-lg"],[1,"mb-4","text-red-500"]],template:function(n,t){n&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),d("click",function(){return t.openPointsModal()}),a(3," \u0627\u0633\u062A\u0639\u0644\u0627\u0645 \u0639\u0646 \u0627\u0644\u0646\u0642\u0627\u0637 "),r(),o(4,"div",3)(5,"button",4),d("click",function(){return t.setTab("orders")}),a(6," \u0627\u0644\u0637\u0644\u0628\u0627\u062A "),r(),o(7,"button",4),d("click",function(){return t.setTab("gifts")}),a(8," \u0627\u0644\u0647\u062F\u0627\u064A\u0627 "),r()()(),v(9,Fe,18,3,"div")(10,Oe,3,1,"div")(11,Ge,6,1,"div",5)(12,De,13,1,"div",5)(13,ze,15,3,"div",5),r(),k(14,"app-sidenav")),n&2&&(l(5),I("ngClass",t.currentTab()==="orders"?"bg-gray-700 text-white":"bg-gray-950 text-white"),l(2),I("ngClass",t.currentTab()==="gifts"?"bg-gray-700 text-white":"bg-gray-950 text-white"),l(2),f(9,t.currentTab()==="orders"?9:-1),l(),f(10,t.currentTab()==="gifts"?10:-1),l(),f(11,t.showCartModal()?11:-1),l(),f(12,t.showLoginModal()?12:-1),l(),f(13,t.showPointsModal()?13:-1))},dependencies:[F,V,te,Z,ee,K,X,Y,oe,ne,ie,de],encapsulation:2,changeDetection:0})}}return i})();export{mt as HomeComponent};
