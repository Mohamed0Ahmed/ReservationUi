import{l as G}from"./chunk-U5OIGZK2.js";import{a as N,c as R,e as z,n as H}from"./chunk-5LMW7FD6.js";import{$ as l,A as M,Ab as B,Ba as f,D as k,Da as p,Ea as a,G as L,Ia as u,Ja as E,Ka as g,Ma as C,N as m,Na as b,O as h,Oa as y,Qa as j,Ra as W,Ta as q,aa as v,cb as Q,g as A,ia as _,ka as w,ma as T,mb as U,q as D,sa as x,ua as F,va as V,wa as r,wb as $,xa as n,ya as I,zb as P}from"./chunk-GW44SSYG.js";var J=(()=>{class i{constructor(e){this.http=e,this.apiUrl=B.apiUrl}getStores(){return this.http.get(`${this.apiUrl}/stores`)}getDeletedStores(){return this.http.get(`${this.apiUrl}/stores/deleted`)}restoreStore(e){return this.http.put(`${this.apiUrl}/stores/restore/${e}`,{})}deleteStore(e){return this.http.delete(`${this.apiUrl}/stores/${e}`)}createStore(e){return this.http.post(`${this.apiUrl}/stores`,e)}updateStore(e,o){return this.http.put(`${this.apiUrl}/stores/${e}`,o)}static{this.\u0275fac=function(o){return new(o||i)(k(U))}}static{this.\u0275prov=M({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var X=(i,c)=>c.id,Y=()=>["/admin/rooms"],Z=(i,c)=>({storeId:i,storeName:c});function ee(i,c){if(i&1){let e=f();r(0,"button",10),p("click",function(){m(e);let t=a();return h(t.clearSearch())}),u(1," \u0625\u0644\u063A\u0627\u0621 "),n()}}function te(i,c){if(i&1){let e=f();r(0,"button",11),p("click",function(){m(e);let t=a();return h(t.openModal("add"))}),u(1," \u0625\u0636\u0627\u0641\u0629 "),n()}}function ie(i,c){if(i&1&&(r(0,"div",8),u(1),n()),i&2){let e=a();l(),g(" \u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062D\u0644\u0627\u062A ",e.showDeleted()?"\u0645\u062D\u0630\u0648\u0641\u0629":""," ")}}function oe(i,c){if(i&1){let e=f();r(0,"button",22),p("click",function(){m(e);let t=a().$implicit,s=a(2);return h(s.openModal("edit",t.id))}),u(1," \u062A\u0639\u062F\u064A\u0644 "),n(),r(2,"button",23),p("click",function(){m(e);let t=a().$implicit,s=a(2);return h(s.openModal("delete",t.id))}),u(3," \u062D\u0630\u0641 "),n()}}function ne(i,c){if(i&1){let e=f();r(0,"button",24),p("click",function(){m(e);let t=a().$implicit,s=a(2);return h(s.openModal("restore",t.id))}),u(1," \u0627\u0633\u062A\u0639\u0627\u062F\u0629 "),n()}}function re(i,c){if(i&1&&(r(0,"tr",17)(1,"th",18),u(2),n(),r(3,"td",19),u(4),n(),r(5,"td",19)(6,"a",20),u(7),I(8,"i",21),n()(),r(9,"td",19),w(10,oe,4,0)(11,ne,2,0),n()()),i&2){let e=c.$implicit,o=a(2);l(2),g(" ",e.name," "),l(2),E(e.ownerEmail),l(2),T("routerLink",W(6,Y))("queryParams",q(7,Z,e.id,e.name)),l(),g(" ",e.rooms.length," "),l(3),x(10,o.showDeleted()?11:10)}}function se(i,c){if(i&1&&(r(0,"div",12)(1,"table",13)(2,"thead",14)(3,"tr",15)(4,"th",16),u(5,"\u0627\u0633\u0645 \u0627\u0644\u0645\u062D\u0644"),n(),r(6,"th",16),u(7,"\u0625\u064A\u0645\u064A\u0644 \u0627\u0644\u0645\u0627\u0644\u0643"),n(),r(8,"th",16),u(9,"\u0627\u0644\u063A\u0631\u0641"),n(),r(10,"th",16),u(11,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621"),n()()(),r(12,"tbody"),F(13,re,12,10,"tr",17,X),n()()()),i&2){let e=a();l(13),V(e.filteredStores())}}function ue(i,c){if(i&1&&(r(0,"p",31),u(1),n()),i&2){let e=a(2);l(),E(e.modalError())}}function le(i,c){if(i&1){let e=f();r(0,"div",9)(1,"div",25)(2,"h3",26),u(3),n(),r(4,"div",27)(5,"label",28),u(6,"\u0627\u0633\u0645 \u0627\u0644\u0645\u062D\u0644"),n(),r(7,"input",29),y("ngModelChange",function(t){m(e);let s=a();return b(s.newStore().name,t)||(s.newStore().name=t),h(t)}),n()(),r(8,"div",27)(9,"label",28),u(10,"\u0625\u064A\u0645\u064A\u0644 \u0627\u0644\u0645\u0627\u0644\u0643"),n(),r(11,"input",30),y("ngModelChange",function(t){m(e);let s=a();return b(s.newStore().ownerEmail,t)||(s.newStore().ownerEmail=t),h(t)}),n(),w(12,ue,2,1,"p",31),n(),r(13,"div",32)(14,"button",33),p("click",function(){m(e);let t=a();return h(t.closeModal())}),u(15," \u0625\u0644\u063A\u0627\u0621 "),n(),r(16,"button",11),p("click",function(){m(e);let t=a();return h(t.saveStore())}),u(17," \u062D\u0641\u0638 "),n()()()()}if(i&2){let e=a();l(3),g(" ",e.modalAction()==="add"?"\u0625\u0636\u0627\u0641\u0629 \u0645\u062D\u0644 \u062C\u062F\u064A\u062F":"\u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0645\u062D\u0644"," "),l(4),C("ngModel",e.newStore().name),l(4),C("ngModel",e.newStore().ownerEmail),l(),x(12,e.modalError()?12:-1)}}function ae(i,c){if(i&1){let e=f();r(0,"div",9)(1,"div",25)(2,"h3",26),u(3),n(),r(4,"p",34),u(5),n(),r(6,"div",32)(7,"button",33),p("click",function(){m(e);let t=a();return h(t.closeModal())}),u(8," \u0625\u0644\u063A\u0627\u0621 "),n(),r(9,"button",35),p("click",function(){m(e);let t=a();return h(t.confirmAction())}),u(10," \u062A\u0623\u0643\u064A\u062F "),n()()()()}if(i&2){let e=a();l(3),g(" ",e.modalAction()==="delete"?"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062D\u0630\u0641":"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u0627\u0633\u062A\u0639\u0627\u062F\u0629"," "),l(2),g(" \u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0623\u0646\u0643 \u062A\u0631\u064A\u062F ",e.modalAction()==="delete"?"\u062D\u0630\u0641 \u0647\u0630\u0627 \u0627\u0644\u0645\u062D\u0644\u061F":"\u0627\u0633\u062A\u0639\u0627\u062F\u0629 \u0647\u0630\u0627 \u0627\u0644\u0645\u062D\u0644\u061F"," ")}}var Ce=(()=>{class i{constructor(e,o){this.storeService=e,this.toastr=o,this.activeStores=_([]),this.deletedStores=_([]),this.searchQuery=_(""),this.showDeleted=_(!1),this.modalError=_(""),this.showModal=_(!1),this.modalAction=_("add"),this.selectedStoreId=_(null),this.newStore=_({name:"",ownerEmail:""}),this.searchSubject=new A,this.filteredStores=Q(()=>{let t=this.searchQuery().toLowerCase();return(this.showDeleted()?this.deletedStores():this.activeStores()).filter(d=>d.name.toLowerCase().includes(t))}),this.loadStores(),this.loadDeletedStores(),this.searchSubject.pipe(D(300)).subscribe(t=>{this.searchQuery.set(t)})}loadStores(){this.storeService.getStores().subscribe({next:e=>{e.isSuccess&&e.data&&this.activeStores.set(e.data)},error:e=>{this.toastr.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0645\u062A\u0627\u062C\u0631\u060C \u062D\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649")}})}loadDeletedStores(){this.storeService.getDeletedStores().subscribe({next:e=>{e.isSuccess&&e.data&&this.deletedStores.set(e.data)},error:e=>{this.toastr.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0645\u062A\u0627\u062C\u0631 \u0627\u0644\u0645\u062D\u0630\u0648\u0641\u0629\u060C \u062D\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649")}})}onSearchChange(e){this.searchSubject.next(e)}toggleShowDeleted(){this.showDeleted.update(e=>!e),this.showDeleted()&&this.deletedStores().length===0&&this.loadDeletedStores()}clearSearch(){this.searchQuery.set(""),this.searchSubject.next("")}openModal(e,o){if(this.modalAction.set(e),this.showModal.set(!0),this.selectedStoreId.set(o??null),this.modalError.set(""),e==="edit"&&o!=null){let t=this.showDeleted()?this.deletedStores().find(s=>s.id===o):this.activeStores().find(s=>s.id===o);t&&this.newStore.set({name:t.name,ownerEmail:t.ownerEmail})}else this.newStore.set({name:"",ownerEmail:""})}closeModal(){this.showModal.set(!1),this.modalError.set(""),this.newStore.set({name:"",ownerEmail:""}),this.selectedStoreId.set(null),this.modalAction.set("add")}saveStore(){let e=this.newStore(),o=this.modalAction(),t=this.selectedStoreId();if(!e.name||!e.ownerEmail){this.modalError.set("\u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0642\u0648\u0644 \u0645\u0637\u0644\u0648\u0628\u0629");return}(o==="add"?this.storeService.createStore(e):this.storeService.updateStore(t,e)).subscribe({next:d=>{d.isSuccess?(this.loadStores(),this.toastr.success(d.message),this.closeModal()):(this.modalError.set(d.message),this.toastr.error(d.message))},error:d=>{this.modalError.set("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062D\u0641\u0638\u060C \u062D\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649"),this.toastr.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062D\u0641\u0638")}})}confirmAction(){let e=this.modalAction(),o=this.selectedStoreId();if(!o)return;(e==="delete"?this.storeService.deleteStore(o):this.storeService.restoreStore(o)).subscribe({next:s=>{if(s.isSuccess){if(e==="delete"){let d=this.activeStores().find(S=>S.id===o);d&&(this.activeStores.set(this.activeStores().filter(S=>S.id!==o)),this.deletedStores.set([...this.deletedStores(),d]))}else{let d=this.deletedStores().find(S=>S.id===o);d&&(this.deletedStores.set(this.deletedStores().filter(S=>S.id!==o)),this.activeStores.set([...this.activeStores(),d]))}this.loadStores(),this.loadDeletedStores(),this.toastr.success(s.message),this.closeModal()}else this.modalError.set(s.message),this.toastr.error(s.message)},error:s=>{this.modalError.set("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u0639\u0645\u0644\u064A\u0629\u060C \u062D\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649"),this.toastr.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u0639\u0645\u0644\u064A\u0629")}})}static{this.\u0275fac=function(o){return new(o||i)(v(J),v(G))}}static{this.\u0275cmp=L({type:i,selectors:[["app-store-list"]],standalone:!0,features:[j],decls:13,vars:7,consts:[["dir","rtl",1,"p-4"],[1,"mb-4","md:flex","justify-between"],[1,"text-center"],["type","text","placeholder","\u0627\u0628\u062D\u062B \u0639\u0646 \u0627\u0633\u0645 \u0627\u0644\u0645\u062D\u0644...",1,"px-4","py-2","border","border-gray-600","rounded-lg","bg-gray-700","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"px-3","py-2","bg-gray-600","text-white","rounded-lg","hover:bg-gray-700"],[1,"text-center","flex","justify-around","p-4"],[1,"px-4","py-2","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600",3,"click"],[1,"px-4","py-2","bg-green-500","text-white","rounded-lg","hover:bg-green-600"],[1,"text-center","text-gray-400"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","justify-center","items-center","z-50"],[1,"px-3","py-2","bg-gray-600","text-white","rounded-lg","hover:bg-gray-700",3,"click"],[1,"px-4","py-2","bg-green-500","text-white","rounded-lg","hover:bg-green-600",3,"click"],[1,"relative","overflow-x-auto","shadow-md","sm:rounded-lg"],[1,"w-full","text-sm","text-right","text-gray-400"],[1,"text-xs","text-white","uppercase","bg-gray-700"],[1,"text-center","font-bold"],["scope","col",1,"px-6","py-3"],[1,"odd:bg-gray-900","even:bg-gray-800","border-b","border-gray-700","text-center","text-white"],["scope","row",1,"px-6","py-4","font-medium","whitespace-nowrap"],[1,"px-6","py-4"],[1,"font-medium","text-blue-500",3,"routerLink","queryParams"],[1,"fa-solid","fa-square-up-right"],[1,"px-3","py-1","mx-1","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600",3,"click"],[1,"px-3","py-1","mx-1","bg-red-500","text-white","rounded-lg","hover:bg-red-600",3,"click"],[1,"px-3","py-1","mx-1","bg-green-500","text-white","rounded-lg","hover:bg-green-600",3,"click"],[1,"bg-gray-800","rounded-lg","p-6","shadow-lg","max-w-sm","w-full"],[1,"text-lg","font-semibold","text-white","mb-4"],[1,"mb-4"],[1,"block","text-sm","font-medium","text-gray-400","mb-1"],["type","text",1,"w-full","px-3","py-2","border","border-gray-600","rounded-lg","bg-gray-700","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","email",1,"w-full","px-3","py-2","border","border-gray-600","rounded-lg","bg-gray-700","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"text-red-500","text-sm","mt-1"],[1,"flex","justify-end","space-x-2","space-x-reverse"],[1,"px-4","py-2","bg-gray-600","text-white","rounded-lg","hover:bg-gray-700",3,"click"],[1,"mb-4","text-gray-400"],[1,"px-4","py-2","bg-red-500","text-white","rounded-lg","hover:bg-red-600",3,"click"]],template:function(o,t){o&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"input",3),y("ngModelChange",function(d){return b(t.searchQuery,d)||(t.searchQuery=d),d}),p("ngModelChange",function(d){return t.onSearchChange(d)}),n(),w(4,ee,2,0,"button",4),n(),r(5,"div",5)(6,"button",6),p("click",function(){return t.toggleShowDeleted()}),u(7),n(),w(8,te,2,0,"button",7),n()(),w(9,ie,2,1,"div",8)(10,se,15,0)(11,le,18,4,"div",9)(12,ae,11,2,"div",9),n()),o&2&&(l(3),C("ngModel",t.searchQuery),l(),x(4,t.searchQuery()?4:-1),l(3),g(" ",t.showDeleted()?" \u0627\u0644\u0645\u062D\u0644\u0627\u062A \u0627\u0644\u0646\u0634\u0637\u0629":" \u0627\u0644\u0645\u062D\u0644\u0627\u062A \u0627\u0644\u0645\u062D\u0630\u0648\u0641\u0629"," "),l(),x(8,t.showDeleted()?-1:8),l(),x(9,t.filteredStores().length===0?9:10),l(2),x(11,t.showModal()&&(t.modalAction()==="add"||t.modalAction()==="edit")?11:-1),l(),x(12,t.showModal()&&(t.modalAction()==="delete"||t.modalAction()==="restore")?12:-1))},dependencies:[H,N,R,z,P,$]})}}return i})();export{Ce as StoreListComponent};
