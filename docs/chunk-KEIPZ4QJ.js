import{l as q}from"./chunk-U5OIGZK2.js";import{a as W,c as N,e as Q,n as U}from"./chunk-5LMW7FD6.js";import{$ as a,A as M,Ab as $,Ba as w,D as L,Da as h,Ea as l,G as k,Ia as u,Ja as S,Ka as f,Ma as R,N as c,Na as y,O as p,Oa as v,Qa as F,aa as b,cb as V,g as A,ia as _,ka as C,mb as I,q as E,sa as g,tb as j,ua as T,va as D,wa as s,xa as n}from"./chunk-GW44SSYG.js";var P=(()=>{class o{constructor(e){this.http=e,this.apiUrl=`${$.apiUrl}/rooms`}getRooms(e){return this.http.get(`${this.apiUrl}/store/${e}`)}getDeletedRooms(e){return this.http.get(`${this.apiUrl}/store/deleted/${e}`)}createRoom(e){return this.http.post(this.apiUrl,e)}updateRoom(e,i){return this.http.put(`${this.apiUrl}/${e}`,i)}deleteRoom(e){return this.http.delete(`${this.apiUrl}/${e}`)}restoreRoom(e){return this.http.put(`${this.apiUrl}/restore/${e}`,{})}static{this.\u0275fac=function(i){return new(i||o)(L(I))}}static{this.\u0275prov=M({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var H=(o,m)=>m.id;function G(o,m){if(o&1){let e=w();s(0,"button",11),h("click",function(){c(e);let t=l();return p(t.clearSearch())}),u(1," \u0625\u0644\u063A\u0627\u0621 "),n()}}function J(o,m){if(o&1){let e=w();s(0,"button",12),h("click",function(){c(e);let t=l();return p(t.openModal("add"))}),u(1," \u0625\u0636\u0627\u0641\u0629 \u063A\u0631\u0641\u0629 \u062C\u062F\u064A\u062F\u0629 "),n()}}function K(o,m){if(o&1&&(s(0,"h2",8),u(1),n()),o&2){let e=l();a(),f("\u063A\u0631\u0641 \u0645\u062A\u062C\u0631: ",e.storeName(),"")}}function O(o,m){o&1&&(s(0,"p",13),u(1,"\u062C\u0627\u0631\u064D \u062A\u062D\u0645\u064A\u0644 \u0627\u0633\u0645 \u0627\u0644\u0645\u062A\u062C\u0631..."),n())}function X(o,m){if(o&1&&(s(0,"div",9),u(1),n()),o&2){let e=l();a(),f(" \u0644\u0627 \u062A\u0648\u062C\u062F \u063A\u0631\u0641 ",e.showDeleted()?"\u0645\u062D\u0630\u0648\u0641\u0629":""," ")}}function Y(o,m){if(o&1){let e=w();s(0,"button",21),h("click",function(){c(e);let t=l().$implicit,r=l(2);return p(r.openModal("edit",t.id))}),u(1," \u062A\u0639\u062F\u064A\u0644 "),n(),s(2,"button",22),h("click",function(){c(e);let t=l().$implicit,r=l(2);return p(r.openModal("delete",t.id))}),u(3," \u062D\u0630\u0641 "),n()}}function Z(o,m){if(o&1){let e=w();s(0,"button",23),h("click",function(){c(e);let t=l().$implicit,r=l(2);return p(r.openModal("restore",t.id))}),u(1," \u0627\u0633\u062A\u0639\u0627\u062F\u0629 "),n()}}function ee(o,m){if(o&1&&(s(0,"tr",18)(1,"th",19),u(2),n(),s(3,"td",20),u(4),n(),s(5,"td",20),C(6,Y,4,0)(7,Z,2,0),n()()),o&2){let e=m.$implicit,i=l(2);a(2),f(" ",e.username," "),a(2),S(e.password),a(2),g(6,i.showDeleted()?7:6)}}function te(o,m){if(o&1&&(s(0,"div",14)(1,"table",15)(2,"thead",16)(3,"tr")(4,"th",17),u(5,"\u0627\u0633\u0645 \u0627\u0644\u063A\u0631\u0641\u0629"),n(),s(6,"th",17),u(7,"\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"),n(),s(8,"th",17),u(9,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621"),n()()(),s(10,"tbody"),T(11,ee,8,3,"tr",18,H),n()()()),o&2){let e=l();a(11),D(e.filteredRooms())}}function oe(o,m){if(o&1&&(s(0,"p",30),u(1),n()),o&2){let e=l(2);a(),S(e.modalError())}}function ie(o,m){if(o&1){let e=w();s(0,"div",10)(1,"div",24)(2,"h3",25),u(3),n(),s(4,"div",26)(5,"label",27),u(6,"\u0627\u0633\u0645 \u0627\u0644\u063A\u0631\u0641\u0629"),n(),s(7,"input",28),v("ngModelChange",function(t){c(e);let r=l();return y(r.newRoom().username,t)||(r.newRoom().username=t),p(t)}),n()(),s(8,"div",26)(9,"label",27),u(10,"\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"),n(),s(11,"input",29),v("ngModelChange",function(t){c(e);let r=l();return y(r.newRoom().password,t)||(r.newRoom().password=t),p(t)}),n(),C(12,oe,2,1,"p",30),n(),s(13,"div",31)(14,"button",32),h("click",function(){c(e);let t=l();return p(t.closeModal())}),u(15," \u0625\u0644\u063A\u0627\u0621 "),n(),s(16,"button",12),h("click",function(){c(e);let t=l();return p(t.saveRoom())}),u(17," \u062D\u0641\u0638 "),n()()()()}if(o&2){let e=l();a(3),f(" ",e.modalAction()==="add"?"\u0625\u0636\u0627\u0641\u0629 \u063A\u0631\u0641\u0629 \u062C\u062F\u064A\u062F\u0629":"\u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u063A\u0631\u0641\u0629"," "),a(4),R("ngModel",e.newRoom().username),a(4),R("ngModel",e.newRoom().password),a(),g(12,e.modalError()?12:-1)}}function ne(o,m){if(o&1){let e=w();s(0,"div",10)(1,"div",24)(2,"h3",25),u(3),n(),s(4,"p",33),u(5),n(),s(6,"div",31)(7,"button",32),h("click",function(){c(e);let t=l();return p(t.closeModal())}),u(8," \u0625\u0644\u063A\u0627\u0621 "),n(),s(9,"button",34),h("click",function(){c(e);let t=l();return p(t.confirmAction())}),u(10," \u062A\u0623\u0643\u064A\u062F "),n()()()()}if(o&2){let e=l();a(3),f(" ",e.modalAction()==="delete"?"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062D\u0630\u0641":"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u0627\u0633\u062A\u0639\u0627\u062F\u0629"," "),a(2),f(" \u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0623\u0646\u0643 \u062A\u0631\u064A\u062F ",e.modalAction()==="delete"?"\u062D\u0630\u0641 \u0647\u0630\u0647 \u0627\u0644\u063A\u0631\u0641\u0629\u061F":"\u0627\u0633\u062A\u0639\u0627\u062F\u0629 \u0647\u0630\u0647 \u0627\u0644\u063A\u0631\u0641\u0629\u061F"," ")}}var _e=(()=>{class o{constructor(e,i,t){this.roomService=e,this.route=i,this.toastr=t,this.activeRooms=_([]),this.deletedRooms=_([]),this.searchQuery=_(""),this.showDeleted=_(!1),this.storeName=_(null),this.modalError=_(""),this.showModal=_(!1),this.modalAction=_("add"),this.selectedRoomId=_(null),this.newRoom=_({username:"",password:""}),this.searchSubject=new A,this.filteredRooms=V(()=>{let r=this.searchQuery().toLowerCase();return(this.showDeleted()?this.deletedRooms():this.activeRooms()).filter(d=>d.username.toLowerCase().includes(r))}),this.storeId=Number(this.route.snapshot.queryParamMap.get("storeId")),this.storeName.set(this.route.snapshot.queryParamMap.get("storeName")||null),this.loadRooms(),this.loadDeletedRooms(),this.searchSubject.pipe(E(300)).subscribe(r=>{this.searchQuery.set(r)})}loadRooms(){this.storeId&&this.roomService.getRooms(this.storeId).subscribe({next:e=>{e.isSuccess&&e.data&&this.activeRooms.set(e.data)},error:e=>{this.toastr.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u063A\u0631\u0641\u060C \u062D\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649")}})}loadDeletedRooms(){this.storeId&&this.roomService.getDeletedRooms(this.storeId).subscribe({next:e=>{e.isSuccess&&e.data&&this.deletedRooms.set(e.data)},error:e=>{this.toastr.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u063A\u0631\u0641 \u0627\u0644\u0645\u062D\u0630\u0648\u0641\u0629\u060C \u062D\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649")}})}onSearchChange(e){this.searchSubject.next(e)}toggleShowDeleted(){this.showDeleted.update(e=>!e),this.showDeleted()&&this.deletedRooms().length===0&&this.storeId&&this.loadDeletedRooms()}clearSearch(){this.searchQuery.set(""),this.searchSubject.next("")}openModal(e,i){if(this.modalAction.set(e),this.showModal.set(!0),this.selectedRoomId.set(i??null),this.modalError.set(""),e==="edit"&&i!=null){let t=this.showDeleted()?this.deletedRooms().find(r=>r.id===i):this.activeRooms().find(r=>r.id===i);t&&this.newRoom.set({username:t.username,password:t.password})}else this.newRoom.set({username:"",password:""})}closeModal(){this.showModal.set(!1),this.modalError.set(""),this.newRoom.set({username:"",password:""}),this.selectedRoomId.set(null),this.modalAction.set("add")}saveRoom(){let e=this.newRoom(),i=this.modalAction(),t=this.selectedRoomId();if(!e.username||!e.password){this.modalError.set("\u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0642\u0648\u0644 \u0645\u0637\u0644\u0648\u0628\u0629");return}let r=i==="add"?{storeId:this.storeId,username:e.username,password:e.password}:{username:e.username,password:e.password};(i==="add"?this.roomService.createRoom(r):this.roomService.updateRoom(t,r)).subscribe({next:d=>{d.isSuccess&&d.data?(this.loadRooms(),this.toastr.success(d.message),this.closeModal()):(this.modalError.set(d.message),this.toastr.error(d.message))},error:d=>{this.modalError.set("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062D\u0641\u0638\u060C \u062D\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649"),this.toastr.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062D\u0641\u0638")}})}confirmAction(){let e=this.modalAction(),i=this.selectedRoomId();if(!i)return;(e==="delete"?this.roomService.deleteRoom(i):this.roomService.restoreRoom(i)).subscribe({next:r=>{r.isSuccess?(e==="delete"?this.activeRooms().find(d=>d.id===i)&&(this.activeRooms.set(this.activeRooms().filter(d=>d.id!==i)),this.showDeleted()&&this.loadDeletedRooms()):this.deletedRooms().find(d=>d.id===i)&&(this.deletedRooms.set(this.deletedRooms().filter(d=>d.id!==i)),this.loadRooms()),this.toastr.success(r.message),this.closeModal()):(this.modalError.set(r.message),this.toastr.error(r.message))},error:r=>{this.modalError.set("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u0639\u0645\u0644\u064A\u0629\u060C \u062D\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649"),this.toastr.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u0639\u0645\u0644\u064A\u0629")}})}static{this.\u0275fac=function(i){return new(i||o)(b(P),b(j),b(q))}}static{this.\u0275cmp=k({type:o,selectors:[["app-rooms-list"]],standalone:!0,features:[F],decls:15,vars:8,consts:[["dir","rtl",1,"p-4"],[1,"flex","justify-between","items-center","mb-4"],[1,"flex","items-center","space-x-4","space-x-reverse"],["type","text","placeholder","\u0627\u0628\u062D\u062B \u0639\u0646 \u0627\u0633\u0645 \u0627\u0644\u063A\u0631\u0641\u0629...",1,"px-4","py-2","border","border-gray-600","rounded-lg","bg-gray-700","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"px-3","py-2","bg-gray-600","text-white","rounded-lg","hover:bg-gray-700"],[1,"flex","space-x-4","space-x-reverse"],[1,"px-4","py-2","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600",3,"click"],[1,"px-4","py-2","bg-green-500","text-white","rounded-lg","hover:bg-green-600"],[1,"text-xl","font-semibold","text-white","mb-4"],[1,"text-center","text-gray-400"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","justify-center","items-center","z-50"],[1,"px-3","py-2","bg-gray-600","text-white","rounded-lg","hover:bg-gray-700",3,"click"],[1,"px-4","py-2","bg-green-500","text-white","rounded-lg","hover:bg-green-600",3,"click"],[1,"text-gray-400","mb-4"],[1,"relative","overflow-x-auto","shadow-md","sm:rounded-lg"],[1,"w-full","text-sm","text-right","text-gray-400"],[1,"text-xs","text-gray-400","uppercase","bg-gray-700"],["scope","col",1,"px-6","py-3"],[1,"odd:bg-gray-900","even:bg-gray-800","border-b","border-gray-700"],["scope","row",1,"px-6","py-4","font-medium","text-white","whitespace-nowrap"],[1,"px-6","py-4"],[1,"px-3","py-1","mx-1","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600",3,"click"],[1,"px-3","py-1","mx-1","bg-red-500","text-white","rounded-lg","hover:bg-red-600",3,"click"],[1,"px-3","py-1","mx-1","bg-green-500","text-white","rounded-lg","hover:bg-green-600",3,"click"],[1,"bg-gray-800","rounded-lg","p-6","shadow-lg","max-w-sm","w-full"],[1,"text-lg","font-semibold","text-white","mb-4"],[1,"mb-4"],[1,"block","text-sm","font-medium","text-gray-400","mb-1"],["type","text",1,"w-full","px-3","py-2","border","border-gray-600","rounded-lg","bg-gray-700","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","password",1,"w-full","px-3","py-2","border","border-gray-600","rounded-lg","bg-gray-700","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"text-red-500","text-sm","mt-1"],[1,"flex","justify-end","space-x-2","space-x-reverse"],[1,"px-4","py-2","bg-gray-600","text-white","rounded-lg","hover:bg-gray-700",3,"click"],[1,"mb-4","text-gray-400"],[1,"px-4","py-2","bg-red-500","text-white","rounded-lg","hover:bg-red-600",3,"click"]],template:function(i,t){i&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"input",3),v("ngModelChange",function(x){return y(t.searchQuery,x)||(t.searchQuery=x),x}),h("ngModelChange",function(x){return t.onSearchChange(x)}),n(),C(4,G,2,0,"button",4),n(),s(5,"div",5)(6,"button",6),h("click",function(){return t.toggleShowDeleted()}),u(7),n(),C(8,J,2,0,"button",7),n()(),C(9,K,2,1,"h2",8)(10,O,2,0)(11,X,2,1,"div",9)(12,te,13,0)(13,ie,18,4,"div",10)(14,ne,11,2,"div",10),n()),i&2&&(a(3),R("ngModel",t.searchQuery),a(),g(4,t.searchQuery()?4:-1),a(3),f(" ",t.showDeleted()?"\u0639\u0631\u0636 \u0627\u0644\u063A\u0631\u0641 \u0627\u0644\u0646\u0634\u0637\u0629":"\u0639\u0631\u0636 \u0627\u0644\u063A\u0631\u0641 \u0627\u0644\u0645\u062D\u0630\u0648\u0641\u0629"," "),a(),g(8,t.showDeleted()?-1:8),a(),g(9,t.storeName()?9:10),a(2),g(11,t.filteredRooms().length===0?11:12),a(2),g(13,t.showModal()&&(t.modalAction()==="add"||t.modalAction()==="edit")?13:-1),a(),g(14,t.showModal()&&(t.modalAction()==="delete"||t.modalAction()==="restore")?14:-1))},dependencies:[U,W,N,Q]})}}return o})();export{_e as RoomListComponent};
