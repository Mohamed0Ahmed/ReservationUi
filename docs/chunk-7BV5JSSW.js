import{a as V}from"./chunk-3LPFTLTC.js";import{a as F}from"./chunk-PYGYMGSD.js";import{l as I}from"./chunk-U5OIGZK2.js";import{a as D,c as k,e as E,n as M}from"./chunk-5LMW7FD6.js";import{$ as l,Ba as f,Da as m,Ea as c,G as y,Ia as u,Ka as C,N as _,O as p,Qa as T,aa as g,ia as x,ka as A,kb as S,ma as b,sa as d,ua as v,va as w,wa as o,xa as s}from"./chunk-GW44SSYG.js";var N=(t,r)=>r.id;function $(t,r){if(t&1){let e=f();o(0,"button",12),m("click",function(){_(e);let i=c().$implicit,a=c(2);return p(a.openModal("edit",i.id))}),u(1," \u062A\u0639\u062F\u064A\u0644 "),s(),o(2,"button",13),m("click",function(){_(e);let i=c().$implicit,a=c(2);return p(a.openModal("delete",i.id))}),u(3," \u062D\u0630\u0641 "),s()}}function j(t,r){t&1&&(o(0,"span",14),u(1,"\u0644\u0627 \u064A\u0645\u0643\u0646 \u0627\u0644\u062A\u0639\u062F\u064A\u0644"),s())}function q(t,r){if(t&1&&(o(0,"div",7)(1,"h3",9),u(2),s(),o(3,"p",10),u(4),s(),o(5,"div",11),A(6,$,4,0)(7,j,2,0),s()()),t&2){let e=r.$implicit,n=c(2);l(2),C(" ",e.name," "),l(2),C(" ",n.isDefaultAssistance(e)?"\u0627\u0641\u062A\u0631\u0627\u0636\u064A":"\u0645\u062E\u0635\u0635"," "),l(2),d(6,n.isDefaultAssistance(e)?7:6)}}function L(t,r){t&1&&(o(0,"div",8),u(1,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A \u0646\u0634\u0637\u0629"),s())}function z(t,r){if(t&1&&(v(0,q,8,3,"div",7,N),A(2,L,2,0,"div",8)),t&2){let e=c();w(e.assistanceTypes()),l(2),d(2,e.assistanceTypes().length?-1:2)}}function B(t,r){if(t&1){let e=f();o(0,"div",7)(1,"h3",9),u(2),s(),o(3,"p",15),u(4,"\u0645\u062E\u0635\u0635"),s(),o(5,"div",11)(6,"button",12),m("click",function(){let i=_(e).$implicit,a=c(2);return p(a.openModal("edit",i.id))}),u(7," \u062A\u0639\u062F\u064A\u0644 "),s(),o(8,"button",16),m("click",function(){let i=_(e).$implicit,a=c(2);return p(a.openModal("restore",i.id))}),u(9," \u0627\u0633\u062A\u0639\u0627\u062F\u0629 "),s()()()}if(t&2){let e=r.$implicit;l(2),C(" ",e.name," ")}}function G(t,r){t&1&&(o(0,"div",8),u(1,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A \u0645\u062D\u0630\u0648\u0641\u0629"),s())}function H(t,r){if(t&1&&(v(0,B,10,1,"div",7,N),A(2,G,2,0,"div",8)),t&2){let e=c();w(e.deletedAssistanceTypes()),l(2),d(2,e.deletedAssistanceTypes().length?-1:2)}}function J(t,r){if(t&1){let e=f();o(0,"div",19)(1,"input",23),m("ngModelChange",function(i){_(e);let a=c(2);return p(a.newAssistanceName.set(i))}),s()()}if(t&2){let e=c(2);l(),b("ngModel",e.newAssistanceName())}}function K(t,r){t&1&&(o(0,"p",20),u(1,"\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 \u0646\u0648\u0639 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629\u061F"),s())}function O(t,r){t&1&&(o(0,"p",20),u(1,"\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u0627\u0633\u062A\u0639\u0627\u062F\u0629 \u0646\u0648\u0639 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629\u061F"),s())}function P(t,r){if(t&1){let e=f();o(0,"button",24),m("click",function(){_(e);let i=c(2);return p(i.saveAssistance())}),u(1," \u062D\u0641\u0638 "),s()}}function Q(t,r){if(t&1){let e=f();o(0,"button",25),m("click",function(){_(e);let i=c(2);return p(i.confirmAction())}),u(1," \u062A\u0623\u0643\u064A\u062F "),s()}}function R(t,r){if(t&1){let e=f();o(0,"div",6)(1,"div",17)(2,"h2",18),u(3),s(),A(4,J,2,1,"div",19)(5,K,2,0,"p",20)(6,O,2,0,"p",20),o(7,"div",11)(8,"button",3),m("click",function(){_(e);let i=c();return p(i.closeModal())}),u(9," \u0625\u0644\u063A\u0627\u0621 "),s(),A(10,P,2,0,"button",21)(11,Q,2,0,"button",22),s()()()}if(t&2){let e=c();l(3),C(" ",e.modalAction()==="add"?"\u0625\u0636\u0627\u0641\u0629":e.modalAction()==="edit"?"\u062A\u0639\u062F\u064A\u0644":e.modalAction()==="delete"?"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062D\u0630\u0641":"\u0627\u0633\u062A\u0639\u0627\u062F\u0629"," \u0646\u0648\u0639 \u0645\u0633\u0627\u0639\u062F\u0629 "),l(),d(4,e.modalAction()!=="delete"&&e.modalAction()!=="restore"?4:-1),l(),d(5,e.modalAction()==="delete"?5:-1),l(),d(6,e.modalAction()==="restore"?6:-1),l(4),d(10,e.modalAction()!=="delete"&&e.modalAction()!=="restore"?10:-1),l(),d(11,e.modalAction()==="delete"||e.modalAction()==="restore"?11:-1)}}var se=(()=>{class t{constructor(e,n,i){this.assistanceService=e,this.toastr=n,this.authService=i,this.assistanceTypes=x([]),this.deletedAssistanceTypes=x([]),this.showDeleted=x(!1),this.showModal=x(!1),this.modalAction=x("add"),this.selectedAssistanceId=x(null),this.newAssistanceName=x(""),this.storeId=x(null),this.storeId.set(parseInt(this.authService.getStoreId()||"0")),this.loadAssistanceTypes()}loadAssistanceTypes(){this.storeId()&&this.assistanceService.getAllAssistanceTypes(this.storeId()).subscribe({next:e=>{e.isSuccess&&e.data&&this.assistanceTypes.set(e.data)},error:()=>{this.toastr.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u0645\u064A\u0644 \u0623\u0646\u0648\u0627\u0639 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629")}})}loadDeletedAssistanceTypes(){this.storeId()&&this.assistanceService.getAllDeletedAssistanceTypes(this.storeId()).subscribe({next:e=>{e.isSuccess&&e.data&&this.deletedAssistanceTypes.set(e.data.filter(n=>this.isCustomAssistance(n)))},error:()=>{this.toastr.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u0645\u064A\u0644 \u0623\u0646\u0648\u0627\u0639 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629 \u0627\u0644\u0645\u062D\u0630\u0648\u0641\u0629")}})}toggleShowDeleted(){this.showDeleted.update(e=>!e),this.showDeleted()&&this.deletedAssistanceTypes().length===0&&this.loadDeletedAssistanceTypes()}openModal(e,n){if(this.modalAction.set(e),this.showModal.set(!0),this.selectedAssistanceId.set(n??null),e==="edit"&&n!=null){let a=(this.showDeleted()?this.deletedAssistanceTypes():this.assistanceTypes()).find(h=>h.id===n);a&&this.newAssistanceName.set(a.name)}else this.newAssistanceName.set("")}closeModal(){this.showModal.set(!1),this.newAssistanceName.set(""),this.selectedAssistanceId.set(null),this.modalAction.set("add")}saveAssistance(){let e=this.newAssistanceName(),n=this.modalAction(),i=this.selectedAssistanceId();if(!e&&n!=="delete"&&n!=="restore"||!this.storeId())return;let a;if(n==="add")a=this.assistanceService.createAssistanceType(this.storeId(),e);else if(n==="edit"&&i!=null)a=this.assistanceService.updateAssistanceType(i,e);else{this.closeModal();return}a.subscribe({next:h=>{h.isSuccess&&h.data?(this.loadAssistanceTypes(),this.showDeleted()&&this.loadDeletedAssistanceTypes(),this.toastr.success(h.message||"\u062A\u0645\u062A \u0627\u0644\u0639\u0645\u0644\u064A\u0629 \u0628\u0646\u062C\u0627\u062D"),this.closeModal()):this.toastr.error(h.message||"\u0641\u0634\u0644 \u0627\u0644\u0639\u0645\u0644\u064A\u0629")},error:h=>{this.toastr.error(h.message)}})}confirmAction(){let e=this.modalAction(),n=this.selectedAssistanceId();if(!n)return;let i;if(e==="delete")i=this.assistanceService.deleteAssistanceType(n);else if(e==="restore")i=this.assistanceService.restoreAssistanceType(n);else{this.closeModal();return}i.subscribe({next:a=>{a.isSuccess?(this.loadAssistanceTypes(),this.loadDeletedAssistanceTypes(),this.toastr.success(a.message||"\u062A\u0645\u062A \u0627\u0644\u0639\u0645\u0644\u064A\u0629 \u0628\u0646\u062C\u0627\u062D"),this.closeModal()):this.toastr.error(a.message||"\u0641\u0634\u0644 \u0627\u0644\u0639\u0645\u0644\u064A\u0629")},error:()=>{this.toastr.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u0639\u0645\u0644\u064A\u0629")}})}isCustomAssistance(e){return e.id>0&&!this.isDefaultAssistance(e)}isDefaultAssistance(e){return e.id<999}static{this.\u0275fac=function(n){return new(n||t)(g(V),g(I),g(F))}}static{this.\u0275cmp=y({type:t,selectors:[["app-assistance"]],standalone:!0,features:[T],decls:12,vars:5,consts:[["dir","rtl",1,"container","mx-auto","p-6","text-gray-400"],[1,"text-2xl","font-bold","text-white","mb-6"],[1,"mb-6","flex","items-center","gap-3"],[1,"px-4","py-2","bg-gray-600","text-white","rounded-lg","hover:bg-gray-700","transition",3,"click"],[1,"px-4","py-2","bg-green-500","text-white","rounded-lg","hover:bg-green-600","transition",3,"click","disabled"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","p-4"],[1,"w-full","border","border-gray-700","rounded-lg","shadow-sm","p-4"],[1,"text-center","text-gray-400","p-4"],[1,"text-lg","font-semibold","text-white","mb-2"],[1,"text-sm","text-gray-100","font-bold","mb-2"],[1,"flex","justify-end","space-x-2","space-x-reverse"],[1,"px-3","py-1","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600","transition",3,"click"],[1,"px-3","py-1","bg-red-500","text-white","rounded-lg","hover:bg-red-600","transition",3,"click"],[1,"text-gray-300"],[1,"text-sm","text-gray-200","mb-2"],[1,"px-3","py-1","bg-green-500","text-white","rounded-lg","hover:bg-green-600","transition",3,"click"],[1,"bg-gray-800","p-6","rounded-lg","w-full","max-w-sm"],[1,"text-xl","font-bold","text-white","mb-4"],[1,"mb-4"],[1,"mb-4","text-gray-400"],[1,"px-4","py-2","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600","transition"],[1,"px-4","py-2","bg-red-500","text-white","rounded-lg","hover:bg-red-600","transition"],["placeholder","\u0627\u0633\u0645 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629",1,"w-full","px-3","py-2","border","border-gray-600","rounded-lg","bg-gray-700","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"px-4","py-2","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600","transition",3,"click"],[1,"px-4","py-2","bg-red-500","text-white","rounded-lg","hover:bg-red-600","transition",3,"click"]],template:function(n,i){n&1&&(o(0,"div",0)(1,"h1",1),u(2,"\u0623\u0646\u0648\u0627\u0639 \u0627\u0644\u0645\u0633\u0627\u0639\u062F\u0629"),s(),o(3,"div",2)(4,"button",3),m("click",function(){return i.toggleShowDeleted()}),u(5),s(),o(6,"button",4),m("click",function(){return i.openModal("add")}),u(7," \u0625\u0636\u0627\u0641\u0629 \u0646\u0648\u0639 \u0645\u0633\u0627\u0639\u062F\u0629 "),s()(),o(8,"div",5),A(9,z,3,1)(10,H,3,1),s(),A(11,R,12,6,"div",6),s()),n&2&&(l(5),C(" ",i.showDeleted()?"\u0639\u0631\u0636 \u0627\u0644\u0646\u0634\u0637":"\u0639\u0631\u0636 \u0627\u0644\u0645\u062D\u0630\u0648\u0641"," "),l(),b("disabled",!i.storeId()),l(3),d(9,i.showDeleted()?-1:9),l(),d(10,i.showDeleted()?10:-1),l(),d(11,i.showModal()?11:-1))},dependencies:[M,D,k,E,S],encapsulation:2})}}return t})();export{se as AssistanceComponent};
